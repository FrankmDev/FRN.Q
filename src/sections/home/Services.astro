---
import { services } from "../../data/services";
import { siteConfig } from "../../data/site";
---

<section id="services" class="relative bg-background">
  
  {/* HEADER */}
  <header class="relative border-b border-foreground/10">
    {/* Top accent line */}
    <div class="h-1 bg-accent"></div>
    
    {/* Section bar */}
    <div class="px-6 lg:px-16 py-4 flex justify-between items-center border-b border-foreground/10">
      <div class="flex items-center gap-3">
        <div class="w-2 h-2 bg-accent"></div>
        <span class="font-mono text-[10px] tracking-[0.5em] text-muted-foreground uppercase">Section</span>
      </div>
      <span class="services-section-num font-black text-4xl lg:text-5xl text-foreground/20">
        02
      </span>
    </div>

    {/* Main header content */}
    <div class="px-6 lg:px-16 pt-16 lg:pt-24 pb-12 lg:pb-16">
      {/* Label */}
      <div class="services-label-wrapper inline-flex items-center gap-3 mb-8 px-4 py-2 border border-foreground/20">
        <div class="w-1.5 h-1.5 bg-accent"></div>
        <span class="services-label font-mono text-[10px] tracking-[0.4em] text-foreground uppercase">
          Services
        </span>
      </div>

      {/* Title and Meta */}
      <div class="flex flex-col lg:flex-row lg:items-end justify-between gap-8 lg:gap-16">
        {/* Title */}
        <div>
          <h2 class="services-hero-title font-black text-foreground leading-[0.8] tracking-tighter" style="font-size: clamp(6rem, 20vw, 18rem);">
            SERVICES
          </h2>
          {/* Description */}
          <div class="mt-6 lg:mt-8 max-w-2xl">
            <p class="services-hero-text text-lg lg:text-xl text-foreground font-black uppercase leading-[1.1] tracking-tight">
              Transforming ideas into <span class="text-accent">immersive digital experiences</span> through code & design.
            </p>
          </div>
        </div>

        {/* Meta */}
        <div class="services-meta flex items-center gap-8 lg:gap-12 pb-2">
          {/* Services count */}
          <div class="services-meta-item">
            <span class="font-mono text-[10px] tracking-[0.4em] text-muted-foreground uppercase block mb-2">
              Services
            </span>
            <span class="font-black text-5xl lg:text-6xl text-foreground leading-none">
              04
            </span>
          </div>
          
          {/* CTA */}
          <a 
            href="#contact" 
            class="services-cta-link group inline-flex items-center gap-3 font-mono text-xs tracking-[0.2em] uppercase border-2 border-foreground px-5 py-3 hover:bg-foreground hover:text-background transition-all duration-300"
          >
            <span>Hire Me</span>
            <span class="link-arrow transform group-hover:translate-x-1 transition-transform">â†’</span>
          </a>
        </div>
      </div>
    </div>
  </header>

  {/* SERVICES LIST */}
  <div class="services-list">
    {services.map((service, index) => (
      <div 
        class="service-row group relative cursor-pointer border-b border-foreground/10 hover:border-foreground/30 transition-all duration-300"
        data-index={index}
        data-cursor="VIEW"
      >
        {/* Hover background */}
        <div class="absolute inset-0 bg-foreground -z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>

        <div class="relative py-6 lg:py-8 px-6 lg:px-16">
          <div class="flex items-start gap-6 lg:gap-10">
            {/* Number */}
            <div class="service-number font-mono text-sm text-muted-foreground group-hover:text-background/60 pt-2 transition-colors w-8 shrink-0">
              {String(index + 1).padStart(2, "0")}
            </div>

            {/* Content */}
            <div class="flex-1">
              <h3 class="service-title font-display font-black uppercase tracking-tight text-foreground group-hover:text-background transition-colors duration-300 leading-[0.95]" style="font-size: clamp(1.75rem, 5vw, 3.5rem);">
                {service.title}
              </h3>
              
              {/* Description */}
              <p class="service-desc font-mono text-sm text-muted-foreground group-hover:text-background/70 mt-3 max-w-2xl leading-relaxed">
                {service.description}
              </p>
            </div>

            {/* Arrow */}
            <div class="hidden lg:flex items-center gap-2 pt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-background">
                <path d="M7 17L17 7M17 7H7M17 7V17" stroke-linecap="square" stroke-linejoin="miter"/>
              </svg>
            </div>
          </div>
        </div>

        {/* Accent line on hover */}
        <div class="absolute bottom-0 left-0 h-[2px] bg-accent w-0 group-hover:w-full transition-all duration-500 ease-out"></div>
      </div>
    ))}
  </div>

  {/* HOW I WORK - EXPERIMENTAL GRID */}
  <div class="border-t border-foreground/10">
    {/* Section Header */}
    <div class="px-6 lg:px-16 py-8 border-b border-foreground/10">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <div class="w-3 h-3 bg-accent"></div>
          <span class="font-mono text-[10px] tracking-[0.5em] text-muted-foreground uppercase">Process</span>
        </div>
        <span class="font-black text-5xl lg:text-7xl text-foreground/10">04</span>
      </div>
    </div>

    {/* Process Grid - Experimental Layout */}
    <div class="grid grid-cols-1 lg:grid-cols-2">
      {/* Step 1 - Discover */}
      <div class="process-card group relative border-b lg:border-r border-foreground/10 p-8 lg:p-12 overflow-hidden">
        <div class="absolute inset-0 bg-accent origin-left scale-x-0 group-hover:scale-x-100 transition-transform duration-700 ease-out"></div>
        
        <div class="relative z-10">
          <div class="flex items-start justify-between mb-8">
            <span class="font-black text-7xl lg:text-9xl text-foreground/10 group-hover:text-background/20 transition-colors duration-500 leading-none">01</span>
            <div class="w-12 h-12 border-2 border-foreground/20 group-hover:border-background flex items-center justify-center transition-colors duration-300">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-foreground group-hover:text-background transition-colors">
                <circle cx="11" cy="11" r="8"/>
                <path d="m21 21-4.3-4.3"/>
              </svg>
            </div>
          </div>
          
          <h4 class="font-display font-black text-3xl lg:text-4xl text-foreground group-hover:text-background uppercase mb-4 transition-colors duration-300">Discover</h4>
          <p class="font-mono text-sm text-muted-foreground group-hover:text-background/70 leading-relaxed max-w-sm transition-colors duration-300">
            Deep dive into your vision, target audience, and competitive landscape. Strategy comes first.
          </p>
          
          <div class="mt-6 flex flex-wrap gap-2">
            {["Research", "Strategy", "Goals"].map(tag => (
              <span class="font-mono text-[10px] tracking-wider uppercase border border-foreground/20 group-hover:border-background/40 px-2 py-1 text-foreground/60 group-hover:text-background/60 transition-all duration-300">
                {tag}
              </span>
            ))}
          </div>
        </div>
      </div>

      {/* Step 2 - Design */}
      <div class="process-card group relative border-b border-foreground/10 p-8 lg:p-12 overflow-hidden">
        <div class="absolute inset-0 bg-foreground origin-left scale-x-0 group-hover:scale-x-100 transition-transform duration-700 ease-out"></div>
        
        <div class="relative z-10">
          <div class="flex items-start justify-between mb-8">
            <span class="font-black text-7xl lg:text-9xl text-foreground/10 group-hover:text-background/20 transition-colors duration-500 leading-none">02</span>
            <div class="w-12 h-12 border-2 border-foreground/20 group-hover:border-background flex items-center justify-center transition-colors duration-300">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-foreground group-hover:text-background transition-colors">
                <path d="m12 19 7-7 3 3-7 7-3-3z"/>
                <path d="m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                <path d="m2 2 7.5 8.6"/>
                <path d="M22 22l-5.5-5.5"/>
              </svg>
            </div>
          </div>
          
          <h4 class="font-display font-black text-3xl lg:text-4xl text-foreground group-hover:text-background uppercase mb-4 transition-colors duration-300">Design</h4>
          <p class="font-mono text-sm text-muted-foreground group-hover:text-background/70 leading-relaxed max-w-sm transition-colors duration-300">
            Crafting pixel-perfect interfaces with intuitive UX. Every detail is intentional.
          </p>
          
          <div class="mt-6 flex flex-wrap gap-2">
            {["UI/UX", "Prototyping", "Systems"].map(tag => (
              <span class="font-mono text-[10px] tracking-wider uppercase border border-foreground/20 group-hover:border-background/40 px-2 py-1 text-foreground/60 group-hover:text-background/60 transition-all duration-300">
                {tag}
              </span>
            ))}
          </div>
        </div>
      </div>

      {/* Step 3 - Build */}
      <div class="process-card group relative border-b lg:border-b-0 lg:border-r border-foreground/10 p-8 lg:p-12 overflow-hidden">
        <div class="absolute inset-0 bg-accent origin-left scale-x-0 group-hover:scale-x-100 transition-transform duration-700 ease-out"></div>
        
        <div class="relative z-10">
          <div class="flex items-start justify-between mb-8">
            <span class="font-black text-7xl lg:text-9xl text-foreground/10 group-hover:text-background/20 transition-colors duration-500 leading-none">03</span>
            <div class="w-12 h-12 border-2 border-foreground/20 group-hover:border-background flex items-center justify-center transition-colors duration-300">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-foreground group-hover:text-background transition-colors">
                <polyline points="16 18 22 12 16 6"/>
                <polyline points="8 6 2 12 8 18"/>
              </svg>
            </div>
          </div>
          
          <h4 class="font-display font-black text-3xl lg:text-4xl text-foreground group-hover:text-background uppercase mb-4 transition-colors duration-300">Build</h4>
          <p class="font-mono text-sm text-muted-foreground group-hover:text-background/70 leading-relaxed max-w-sm transition-colors duration-300">
            Clean, performant code with smooth animations. Built for scale and maintainability.
          </p>
          
          <div class="mt-6 flex flex-wrap gap-2">
            {["Code", "Animate", "Optimize"].map(tag => (
              <span class="font-mono text-[10px] tracking-wider uppercase border border-foreground/20 group-hover:border-background/40 px-2 py-1 text-foreground/60 group-hover:text-background/60 transition-all duration-300">
                {tag}
              </span>
            ))}
          </div>
        </div>
      </div>

      {/* Step 4 - Deliver */}
      <div class="process-card group relative p-8 lg:p-12 overflow-hidden">
        <div class="absolute inset-0 bg-foreground origin-left scale-x-0 group-hover:scale-x-100 transition-transform duration-700 ease-out"></div>
        
        <div class="relative z-10">
          <div class="flex items-start justify-between mb-8">
            <span class="font-black text-7xl lg:text-9xl text-foreground/10 group-hover:text-background/20 transition-colors duration-500 leading-none">04</span>
            <div class="w-12 h-12 border-2 border-foreground/20 group-hover:border-background flex items-center justify-center transition-colors duration-300">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-foreground group-hover:text-background transition-colors">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                <polyline points="22 4 12 14.01 9 11.01"/>
              </svg>
            </div>
          </div>
          
          <h4 class="font-display font-black text-3xl lg:text-4xl text-foreground group-hover:text-background uppercase mb-4 transition-colors duration-300">Deliver</h4>
          <p class="font-mono text-sm text-muted-foreground group-hover:text-background/70 leading-relaxed max-w-sm transition-colors duration-300">
            Launch with confidence. Ongoing support and optimization to ensure success.
          </p>
          
          <div class="mt-6 flex flex-wrap gap-2">
            {["Launch", "Support", "Grow"].map(tag => (
              <span class="font-mono text-[10px] tracking-wider uppercase border border-foreground/20 group-hover:border-background/40 px-2 py-1 text-foreground/60 group-hover:text-background/60 transition-all duration-300">
                {tag}
              </span>
            ))}
          </div>
        </div>
      </div>
    </div>
  </div>

  {/* CTA */}
  <div class="px-6 lg:px-16 border-t border-foreground/10">
    <a 
      href={`mailto:${siteConfig.email}`}
      class="group block py-12 lg:py-16"
    >
      <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-6">
        <div>
          <span class="font-mono text-[10px] tracking-[0.4em] text-muted-foreground uppercase block mb-3">
            Start a project
          </span>
          <span class="font-display font-black text-2xl md:text-3xl lg:text-5xl text-foreground group-hover:text-accent transition-colors break-all leading-tight">
            {siteConfig.email}
          </span>
        </div>
        <div class="flex items-center gap-4">
          <span class="font-mono text-xs tracking-[0.2em] text-muted-foreground uppercase hidden lg:block">
            Get in touch
          </span>
          <div class="w-12 h-12 lg:w-14 lg:h-14 border-2 border-foreground group-hover:border-accent group-hover:bg-accent flex items-center justify-center transition-all duration-300">
            <svg 
              width="20" 
              height="20" 
              viewBox="0 0 24 24" 
              fill="none" 
              stroke="currentColor" 
              stroke-width="2"
              class="text-foreground group-hover:text-background transition-colors"
            >
              <path d="M7 17L17 7M17 7H7M17 7V17" stroke-linecap="square" stroke-linejoin="miter"/>
            </svg>
          </div>
        </div>
      </div>
    </a>
  </div>

</section>

<style>
  .service-row,
  .service-number,
  .service-title,
  .process-card {
    opacity: 0;
  }

  .service-row {
    transform: translateY(15px);
  }

  .service-number {
    transform: translateX(-10px);
  }

  .service-title {
    transform: translateY(10px);
  }

  .process-card {
    opacity: 0;
    transform: translateY(30px);
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const triggers: ScrollTrigger[] = [];

  // Service rows
  const rows = document.querySelectorAll('.service-row');
  
  rows.forEach((row, index) => {
    const number = row.querySelector('.service-number') as HTMLElement;
    const title = row.querySelector('.service-title') as HTMLElement;

    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: row,
        start: "top 85%",
        toggleActions: "play none none reverse",
      },
    });

    if (tl.scrollTrigger) triggers.push(tl.scrollTrigger);

    gsap.set(row, { opacity: 0, y: 15 });
    gsap.set(number, { opacity: 0, x: -10 });
    gsap.set(title, { opacity: 0, y: 10 });

    tl.to(row, { opacity: 1, y: 0, duration: 0.5, ease: "power3.out" }, 0);
    tl.to(number, { opacity: 1, x: 0, duration: 0.4, ease: "power2.out" }, 0.1);
    tl.to(title, { opacity: 1, y: 0, duration: 0.5, ease: "power3.out" }, 0.05 + index * 0.04);

    row.addEventListener("mouseenter", () => {
      if (title) gsap.to(title, { x: 8, duration: 0.3, ease: "power2.out" });
    });

    row.addEventListener("mouseleave", () => {
      if (title) gsap.to(title, { x: 0, duration: 0.3, ease: "power2.out" });
    });
  });

  // Process cards
  gsap.to(".process-card", {
    y: 0,
    opacity: 1,
    duration: 0.8,
    stagger: 0.12,
    ease: "power3.out",
    scrollTrigger: {
      trigger: ".process-card",
      start: "top 85%",
      toggleActions: "play none none reverse",
    },
  });

  // Cleanup
  document.addEventListener('astro:before-swap', () => {
    triggers.forEach((trigger) => trigger.kill());
  });
</script>
